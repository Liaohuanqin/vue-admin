<template>
<section>
    <table class="table">
        <thead>
            <tr>
                <td>组件名</td>
                <td>组件值</td>
                <td>组件实例</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>field_sex</td>
                <td>{{field_sex}}</td>
                <td>
                    <field_sex
                        v-model="field_sex"
                    ></field_sex>
                </td>
            </tr>
            <tr>
                <td>field_bool</td>
                <td>{{field_bool}}</td>
                <td>
                    <field_bool
                        v-model="field_bool"
                    ></field_bool>
                </td>
            </tr>
            <tr>
                <td>field_enum_radio</td>
                <td>{{field_enum_radio}}</td>
                <td>
                    <field_enum_radio
                        v-model="field_enum_radio"
                        :candidate="field_enum_candidate"
                        valuefield="valuefield"
                        :handleInvalidValue="handleInvalidValue"
                    ></field_enum_radio>
                </td>
            </tr>
            <tr>
                <td>field_enum_select</td>
                <td>{{field_enum_select}}</td>
                <td>
                    <field_enum_select
                        v-model="field_enum_select"
                        :candidate="field_enum_candidate"
                        valuefield="valuefield"
                        disabled
                        :handleInvalidValue="handleInvalidValue"
                    ></field_enum_select>
                </td>
            </tr>
            <tr>
                <td>field_model</td>
                <td>{{field_model}}</td>
                <td>
                    <field_model
                        v-model="field_model"
                        :candidate="field_enum_candidate"
                        valuefield="valuefield"
                        placeholder="field_model的placeholder"
                        :handleInvalidValue="handleInvalidValue"
                    ></field_model>
                </td>
            </tr>
            <tr>
                <td>field_async_enum_radio</td>
                <td>{{field_async_enum_radio}}</td>
                <td>
                    <field_async_enum_radio
                        v-model="field_async_enum_radio"
                        labelfield="name"
                        valuefield="id"
                        :handleInvalidValue="handleInvalidValue"
                        :httpRequest="httpRequest.field_async_enum_radio"
                    ></field_async_enum_radio>
                </td>
            </tr>
            <tr>
                <td>field_async_enum_select</td>
                <td>{{field_async_enum_select}}</td>
                <td>
                    <field_async_enum_select
                        v-model="field_async_enum_select"
                        labelfield="name"
                        valuefield="id"
                        placeholder="the placeholder"
                        :handleInvalidValue="handleInvalidValue"
                        :httpRequest="httpRequest.field_async_enum_select"
                    ></field_async_enum_select>
                </td>
            </tr>
            <tr>
                <td>field_async_model</td>
                <td>{{field_async_model}}</td>
                <td>
                    <field_async_model
                        v-model="field_async_model"
                        labelfield='name'
                        valuefield='id'
                        placeholder="placeholder"
                        :handleInvalidValue="handleInvalidValue"
                        :httpRequest="httpRequest.field_async_model"
                    ></field_async_model>
                </td>
            </tr>



        </tbody>
    </table>
</section>
</template>

<script>
import field_sex from "@/components/common/editor/field_sex.vue"
import field_bool from "@/components/common/editor/field_bool.vue"

import field_enum_radio from "@/components/common/editor/field_enum_radio"
import field_enum_select from "@/components/common/editor/field_enum_select"
import field_model from "@/components/common/editor/field_model"

import field_async_enum_radio from "@/components/common/editor/field_async_enum_radio"
import field_async_enum_select from "@/components/common/editor/field_async_enum_select"
import field_async_model from "@/components/common/editor/field_async_model"






import axios from "@/server/axios"

const fields = [
    "field_async_enum_radio",
    "field_async_enum_select",
    "field_async_model",
];

const httpRequest = fields.reduce((obj,field)=>{
    obj[field] = (cb)=>{
        return axios.get(`/test/${field}`).then((json)=>{
            cb(json.data.data)
        })
    }
    return obj;
},{});


export default{
    components:{
        field_sex,
        field_bool,
        field_enum_radio,
        field_enum_select,
        field_model,
        field_async_enum_radio,
        field_async_enum_select,
        field_async_model,
    },
    config:{
        field_enum_candidate:[
            {valuefield:1,label:"eins"},
            {valuefield:2,label:"zwei"},
            {valuefield:3,label:"drei"},
            {valuefield:4,label:"fuer"},
        ],
        handleInvalidValue:function(value,options){
            this.$emit('input',options[Math.floor(Math.random()*options.length)]);
            // console.log(value,options);
        },
        httpRequest,
    },
    data(){
        return {
            field_sex:0,
            field_bool:0,
            field_enum_radio:0,
            field_enum_select:0,
            field_model:"",
            field_async_enum_radio:"",
            field_async_enum_select:"",
            field_async_model:1,

        }
    },
    beforeCreate(){

    },


    created(){


        // setTimeout(()=>{
        //     this.field_sex = 1;
        //     this.field_bool = 1;
        //     this.field_enum_radio = 1;
        //     this.field_enum_select = 2;
        //     this.field_model = 3;

        // },2000)
    }
}
</script>